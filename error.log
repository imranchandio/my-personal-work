Adding driver java options: -Dlog4j2.configurationFile=file:///etc/spark/conf/log4j2.xml -Dsss.kubernetes.opc-request-id=csid4b5ec0f3462dacdcd5e13cca184c/a13e8c6c9a08474e9dc58016356ad111/A35F069290A23E747A0E3FB55DD50470  -XX:-UseJVMCICompiler -XX:+EagerJVMCI -Dgraal.ShowConfiguration=info  -Doracle.net.keepAlive=true -Doracle.net.TCP_KEEPIDLE=300 -Doracle.net.TCP_KEEPINTERVAL=60 -Doracle.net.TCP_KEEPCOUNT=5 -javaagent:/opt/spark/ext/classpath/prism-agent.jar --add-opens=java.base/java.lang=ALL-UNNAMED              --add-opens=java.base/java.lang.invoke=ALL-UNNAMED              --add-opens=java.base/java.lang.reflect=ALL-UNNAMED              --add-opens=java.base/java.io=ALL-UNNAMED              --add-opens=java.base/java.net=ALL-UNNAMED              --add-opens=java.base/java.nio=ALL-UNNAMED              --add-opens=java.base/java.util=ALL-UNNAMED              --add-opens=java.base/java.util.concurrent=ALL-UNNAMED              --add-opens=java.base/java.util.concurrent.atomic=ALL-UNNAMED              --add-opens=java.base/sun.nio.ch=ALL-UNNAMED              --add-opens=java.base/sun.nio.cs=ALL-UNNAMED              --add-opens=java.base/sun.security.action=ALL-UNNAMED              --add-opens=java.base/sun.util.calendar=ALL-UNNAMED              --add-opens=java.security.jgss/sun.security.krb5=ALL-UNNAMED              -Djdk.reflect.useDirectMethodHandle=false
[Use -Dgraal.LogFile=<path> to redirect Graal log output to a file.]
Using "Graal Enterprise compiler with Truffle extensions" loaded from class files
Creating DataFlowDefaultLogAppender application log appender based on Log4j2 File Appender.
Creating DataFlowDefaultLogAppender diagnostic log appender based on Log4j2 Console Appender.
[MAIN] Starting P6 PDS extract at 2025-11-24 11:21:32
[MAIN] OS_NAMESPACE      = axjj8sdvrg1w
[MAIN] OS_BUCKET         = bkt-neom-enowa-des-dev-data-landing
[MAIN] OS_PREFIX_META    = common/API/P6/metadata
[MAIN] OS_PREFIX_DATA    = common/API/P6/data
[MAIN] OS_PREFIX_INDEX   = common/API/P6/logs
[MAIN] P6_ENV_CSV_OCI_URI        = oci://bkt-neom-enowa-des-dev-data-landing@axjj8sdvrg1w/common/config/p6/env_variables.csv
[MAIN] P6_TABLE_CSV_OCI_URI      = oci://bkt-neom-enowa-des-dev-data-landing@axjj8sdvrg1w/common/config/p6/table_config_template.csv
[MAIN] P6_ENV_CSV_OCI_URI_FALLBACK   = None
[MAIN] P6_TABLE_CSV_OCI_URI_FALLBACK = None
[CFG] Attempting primary env CSV: oci://bkt-neom-enowa-des-dev-data-landing@axjj8sdvrg1w/common/config/p6/env_variables.csv
[DIAG][OCI] Requested URI: oci://bkt-neom-enowa-des-dev-data-landing@axjj8sdvrg1w/common/config/p6/env_variables.csv
[SIGNER] Using Instance Principals signer
[DIAG][OCI][PRE-CHECK] Bucket access check failed for bucket 'bkt-neom-enowa-des-dev-data-landing' in namespace 'axjj8sdvrg1w'. Details: {"status": 404, "code": "BucketNotFound", "message": "The bucket 'bkt-neom-enowa-des-dev-data-landing' does not exist in namespace 'axjj8sdvrg1w'", "request_endpoint": "GET https://objectstorage.me-jeddah-1.oraclecloud.com/n/axjj8sdvrg1w/b/bkt-neom-enowa-des-dev-data-landing", "opc_request_id": null}. Ensure bucket exists, namespace is correct, and caller has OBJECT_READ permission.
[CFG][WARN] Primary env CSV download failed: Bucket access check failed for bucket 'bkt-neom-enowa-des-dev-data-landing' in namespace 'axjj8sdvrg1w'. Details: {"status": 404, "code": "BucketNotFound", "message": "The bucket 'bkt-neom-enowa-des-dev-data-landing' does not exist in namespace 'axjj8sdvrg1w'", "request_endpoint": "GET https://objectstorage.me-jeddah-1.oraclecloud.com/n/axjj8sdvrg1w/b/bkt-neom-enowa-des-dev-data-landing", "opc_request_id": null}. Ensure bucket exists, namespace is correct, and caller has OBJECT_READ permission.
[CFG][FATAL] Failed to load CSV configs: Failed to download env CSV from primary URI: Bucket access check failed for bucket 'bkt-neom-enowa-des-dev-data-landing' in namespace 'axjj8sdvrg1w'. Details: {"status": 404, "code": "BucketNotFound", "message": "The bucket 'bkt-neom-enowa-des-dev-data-landing' does not exist in namespace 'axjj8sdvrg1w'", "request_endpoint": "GET https://objectstorage.me-jeddah-1.oraclecloud.com/n/axjj8sdvrg1w/b/bkt-neom-enowa-des-dev-data-landing", "opc_request_id": null}. Ensure bucket exists, namespace is correct, and caller has OBJECT_READ permission.
[FATAL] Unhandled exception in main:
Traceback (most recent call last):
  File "/tmp/spark-4017c604-81b0-4f98-b446-ee5929cd71bd/p6_pds_extract6_imran.py", line 295, in load_config_from_oci_csvs_with_fallback
    local_env = try_download(primary_env_oci)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/tmp/spark-4017c604-81b0-4f98-b446-ee5929cd71bd/p6_pds_extract6_imran.py", line 290, in try_download
    return download_single_oci_file_diagnostic_or_local(uri, local_target_dir="/tmp", list_on_error=True)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/tmp/spark-4017c604-81b0-4f98-b446-ee5929cd71bd/p6_pds_extract6_imran.py", line 241, in download_single_oci_file_diagnostic_or_local
    raise RuntimeError(friendly)
RuntimeError: Bucket access check failed for bucket 'bkt-neom-enowa-des-dev-data-landing' in namespace 'axjj8sdvrg1w'. Details: {"status": 404, "code": "BucketNotFound", "message": "The bucket 'bkt-neom-enowa-des-dev-data-landing' does not exist in namespace 'axjj8sdvrg1w'", "request_endpoint": "GET https://objectstorage.me-jeddah-1.oraclecloud.com/n/axjj8sdvrg1w/b/bkt-neom-enowa-des-dev-data-landing", "opc_request_id": null}. Ensure bucket exists, namespace is correct, and caller has OBJECT_READ permission.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/tmp/spark-4017c604-81b0-4f98-b446-ee5929cd71bd/p6_pds_extract6_imran.py", line 473, in <module>
    main()
  File "/tmp/spark-4017c604-81b0-4f98-b446-ee5929cd71bd/p6_pds_extract6_imran.py", line 447, in main
    env_whitelist, env_blacklist, global_since, per_table_since, env_config = load_config_from_oci_csvs_with_fallback(
                                                                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/tmp/spark-4017c604-81b0-4f98-b446-ee5929cd71bd/p6_pds_extract6_imran.py", line 306, in load_config_from_oci_csvs_with_fallback
    raise RuntimeError(f"Failed to download env CSV from primary URI: {e_primary_env}")
RuntimeError: Failed to download env CSV from primary URI: Bucket access check failed for bucket 'bkt-neom-enowa-des-dev-data-landing' in namespace 'axjj8sdvrg1w'. Details: {"status": 404, "code": "BucketNotFound", "message": "The bucket 'bkt-neom-enowa-des-dev-data-landing' does not exist in namespace 'axjj8sdvrg1w'", "request_endpoint": "GET https://objectstorage.me-jeddah-1.oraclecloud.com/n/axjj8sdvrg1w/b/bkt-neom-enowa-des-dev-data-landing", "opc_request_id": null}. Ensure bucket exists, namespace is correct, and caller has OBJECT_READ permission.
Traceback (most recent call last):
  File "/tmp/spark-4017c604-81b0-4f98-b446-ee5929cd71bd/p6_pds_extract6_imran.py", line 295, in load_config_from_oci_csvs_with_fallback
    local_env = try_download(primary_env_oci)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/tmp/spark-4017c604-81b0-4f98-b446-ee5929cd71bd/p6_pds_extract6_imran.py", line 290, in try_download
    return download_single_oci_file_diagnostic_or_local(uri, local_target_dir="/tmp", list_on_error=True)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/tmp/spark-4017c604-81b0-4f98-b446-ee5929cd71bd/p6_pds_extract6_imran.py", line 241, in download_single_oci_file_diagnostic_or_local
    raise RuntimeError(friendly)
RuntimeError: Bucket access check failed for bucket 'bkt-neom-enowa-des-dev-data-landing' in namespace 'axjj8sdvrg1w'. Details: {"status": 404, "code": "BucketNotFound", "message": "The bucket 'bkt-neom-enowa-des-dev-data-landing' does not exist in namespace 'axjj8sdvrg1w'", "request_endpoint": "GET https://objectstorage.me-jeddah-1.oraclecloud.com/n/axjj8sdvrg1w/b/bkt-neom-enowa-des-dev-data-landing", "opc_request_id": null}. Ensure bucket exists, namespace is correct, and caller has OBJECT_READ permission.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/tmp/spark-4017c604-81b0-4f98-b446-ee5929cd71bd/p6_pds_extract6_imran.py", line 473, in <module>
    main()
  File "/tmp/spark-4017c604-81b0-4f98-b446-ee5929cd71bd/p6_pds_extract6_imran.py", line 447, in main
    env_whitelist, env_blacklist, global_since, per_table_since, env_config = load_config_from_oci_csvs_with_fallback(
                                                                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/tmp/spark-4017c604-81b0-4f98-b446-ee5929cd71bd/p6_pds_extract6_imran.py", line 306, in load_config_from_oci_csvs_with_fallback
    raise RuntimeError(f"Failed to download env CSV from primary URI: {e_primary_env}")
RuntimeError: Failed to download env CSV from primary URI: Bucket access check failed for bucket 'bkt-neom-enowa-des-dev-data-landing' in namespace 'axjj8sdvrg1w'. Details: {"status": 404, "code": "BucketNotFound", "message": "The bucket 'bkt-neom-enowa-des-dev-data-landing' does not exist in namespace 'axjj8sdvrg1w'", "request_endpoint": "GET https://objectstorage.me-jeddah-1.oraclecloud.com/n/axjj8sdvrg1w/b/bkt-neom-enowa-des-dev-data-landing", "opc_request_id": null}. Ensure bucket exists, namespace is correct, and caller has OBJECT_READ permission.
