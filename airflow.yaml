# p6_data_pipeline_details_config.yaml

# ======================================
# BASIC COMPARTMENT / ENV CONFIG
# ======================================
compartment_id: "ocid1.compartment.oc1..aaaaaaaagqvd5cybmsllqqkbligbbij6oueegrkrjyusjfikqnvdpovs0laq"

shared_dag_config:
  retries: 3
  retry_delay: 300          # seconds
  max_active_runs: 1
  catchup: false
  start_date: "2024-11-20T00:00:00"   # ISO 8601
  run_poll_interval: 60               # seconds between status checks

# ======================================
# SHARED DATA FLOW SETTINGS
# (NO POOL, NO PRIVATE ENDPOINT)
# ======================================
shared_dataflow_config:
  driver_shape: "VM.Standard.E4.Flex"
  executor_shape: "VM.Standard.E4.Flex"

  driver_shape_config:
    ocpus: 2
    memory_in_gbs: 16

  executor_shape_config:
    ocpus: 2
    memory_in_gbs: 16

  num_executors: 2

  logs_bucket_uri: "oci://bkt-neom-enowa-synergyze-dev-data-operations@axjj8sdvrg1w/dataflow-applications/logs/"

# ======================================
# DAG CONFIG (SIMPLE: SINGLE TASK)
# ======================================
dag_configs:
  simple:
    dag_id: "airflow_dag_p6_simple_dataflow"
    description: "Simple DAG to trigger a single OCI Data Flow application"
    schedule_interval: "0 2 * * *"   # Runs every day at 02:00
    retries: 3
    retry_delay: 300
    max_active_runs: 1
    catchup: false
    run_poll_interval: 60
    tasks:
      - p6_simple_app

# ======================================
# DATA FLOW APPLICATION DEFINITION
# ======================================
Applications:
  details:
    p6_simple_app:
      display_name: "df-app-p6-simple-dataflow"

      # >>> PASTE YOUR FULL APP OCID FROM OCI HERE <<<
      # e.g. ocid1.dataflowapplication.oc1.me-jeddah-1.anvgkljrsvw...
      application_id: "ocid1.dataflowapplication.oc1.me-jeddah-1.YOUR_FULL_APP_OCID_HERE"

      # Optional: arguments passed to the job
      arguments: []

# ======================================
# PER-APP SETTINGS (NO POOL/ENDPOINT)
# ======================================
dataflow_app:
  - application_key: p6_simple_app
    logs_bucket_uri: "oci://bkt-neom-enowa-synergyze-dev-data-operations@axjj8sdvrg1w/dataflow-applications/logs/"
